%
% Copyright (C) 2016 LaTeX3 Project
%

\documentclass{minimal}
\input{regression-test}

\RequirePackage[check-declarations,log-functions]{expl3}

\begin{document}
\START
\AUTHOR{Bruno Le Floch}
\ExplSyntaxOn

\cs_if_exist_use:NT \pdftex_setrandomseed:D { 0 }
\OMIT
\cs_if_exist:NTF \pdftex_uniformdeviate:D
  { \cs_new:Npn \test:n #1 { \prg_replicate:nn { 5 } { \fp_to_tl:n {#1} \NEWLINE } } }
  { \cs_new:Npn \test:n #1 { \fp_to_tl:n {#1} , ~ } }
\TIMO

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Random~floating~point~number }
  {
    \test:n { rand() }
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Random~integer }
  {
    \test:n { randint(2) }
    \test:n { randint(-9999 9999 9999 9999, -9999 9999 9999 9998) }
    \test:n { randint(-10 0000 0000, 10 0000 0000) }
    \test:n { randint(9.9e15) }
    \test:n { randint(-9999 9999 9999 9999, 9999 9999 9999 9999) }
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Random~bad~arguments }
  {
    \fp_to_tl:n { rand(,) } \NEWLINE
    \fp_to_tl:n { rand(1,2,3) } \NEWLINE
    \fp_to_tl:n { rand(nan) } \NEWLINE
    \fp_to_tl:n { randint() } \NEWLINE
    \fp_to_tl:n { randint(1) } \NEWLINE
    \fp_to_tl:n { randint(1,0) } \NEWLINE
    \fp_to_tl:n { randint(1e16) } \NEWLINE
    \fp_to_tl:n { randint(9.9e15, 1e16) } \NEWLINE
    \fp_to_tl:n { randint(-1e16, -1e15) } \NEWLINE
    \fp_to_tl:n { randint(1,2,3) } \NEWLINE
    \fp_to_tl:n { randint(nan) } \NEWLINE
    \fp_to_tl:n { randint(inf) } \NEWLINE
    \fp_to_tl:n { randint(nan,0) } \NEWLINE
    \fp_to_tl:n { randint(inf,0) } \NEWLINE
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\END
